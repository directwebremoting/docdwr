<!DOCTYPE html>
<html><head>
  <title>Remoting Options</title>

  
  
  <meta name="weight" content="5">

  
  <link rel="stylesheet" type="text/css" href="../media/styles.css">

</head><body>
<h2>Remoting Options<br>
</h2>

DWR provides two remoting options:<br>

<br>

1) <span style="font-weight: bold;">DWR native</span> - By default DWR
uses a superset of JSON that we like to call JavaScript. This was
initially done to cope with recursive data, XML objects, etc., which
the original JSON specifications had a difficult time dealing with. In
this remoting mode DWR's client side&nbsp; engine (engine.js) handles
preparing and executing the call to the server.&nbsp; Most of the
documentation on this site deals with DWR native.&nbsp; <br>

<br>

2) <span style="font-weight: bold;">JSON/JSONP</span> - In DWR 3 a
JSON/JSONP RESTian API has been added that allows users to access Java
services exposed to DWR via an URL: <code>http://example.com/dwr/jsonp/ClassName/methodName/param1/param2</code>
DWR will reply with a JSON structure containing the result of calling
ClassName.methodName("param1", "param2");<br>

<br>

This allows for seamless integration with JavaScript toolkits (DOJO,
ExtJs, jQuery, etc.) while eliminating the need for the developer to
convert the return types of their exposed Java methods into JSON
manually - DWR's server engine handles this.<br>

<br>

<h2>Getting Started with JSON/JSONP</h2>

In order to enable JSON/JSONP you must
add the jsonpEnabled init-param to your DWR servlet definition in your
web.xml.&nbsp; This parameter activates the JSON/JSONP service.
<pre><code>   ...<br>  &lt;display-name&gt;DWR Servlet&lt;/display-name&gt;<br> &lt;servlet&gt;<br>    &lt;servlet-name&gt;dwr-invoker&lt;/servlet-name&gt;<br>        &lt;description&gt;Direct Web Remoter Servlet&lt;/description&gt;<br>    &lt;servlet-class&gt;org.directwebremoting.servlet.DwrServlet&lt;/servlet-class&gt;<br>    &lt;init-param&gt;<br>     &lt;param-name&gt;jsonpEnabled&lt;/param-name&gt;<br>     &lt;param-value&gt;true&lt;/param-value&gt;<br>    &lt;/init-param&gt;<br>    ...	    </code></pre>

<h2>JSON/JSONP URL construction</h2>

The following URL illustrates an example of using JSON/JSONP remoting
(from an example in the <a href="../downloads/index.html">dwr.war</a>):<br>

../../../dwr/jsonp/People/setPerson?param0=" +
encodeURIComponent($.toJSON(person)<br>

<ol>

  <li><span style="font-weight: bold;">../../../dwr/</span> - First you
must specify the path to the DWR servlet.&nbsp; Obviously this will
change based on where your page is located.</li>
  <li><span style="font-weight: bold;">jsonp</span> - This tells DWR to
use JSON/JSONP remoting.</li>
  <li><span style="font-weight: bold;">People</span> - This is the name
that you have configured for the Java class you have exposed to DWR.</li>
  <li><span style="font-weight: bold;">setPerson</span> - This is the
name of the Java method you have exposed to DWR and would like to call.</li>
  <li><span style="font-weight: bold;">?param0</span> -&nbsp; This
syntax is required for any parameters that need to be passed to the
Java method, any additional parameters need to follow the following
pattern &amp;paramindex (e.g.
?param0=value0&amp;param1=value1&amp;param2=value2).</li>
  <li style="font-weight: bold;">encodeURIComponent($.toJSON(person) <span style="font-weight: normal;">-</span> <span style="font-weight: normal;">This example assumes you have build a
JavaScript object named person.&nbsp; First we need to serialize the
person object into a JSON&nbsp; string.&nbsp; Many JavaScript toolkits
provide a function to serve this need.&nbsp; In this case we are using
jQuery and the <a href="http://code.google.com/p/jquery-json/" target="new">jquery-json plugin</a>.</span>&nbsp; <span style="font-weight: normal;">We
also highly recommend making sure any parameters passed are properly
encoded, you can do this via JavaScript's encodeURIComponent method.</span>&nbsp;<span style="font-weight: normal;"> A complete example is provided below, to see this example in action please see the dwr.war.&nbsp; </span><br>
  </li>
</ol>

<pre>function writePerson() {<br>  var person = { id:viewed, name:null, address:null, age:null, superhero:null };<br>  dwr.util.getValues(person);<br>  $.post("../../../dwr/jsonp/People/setPerson?param0=" + encodeURIComponent($.toJSON(person)), { },<br>    fillTable, "json"); <br>}</pre>

</body></html>